
Coding style guide
==================


В этом документе даны рекомендации по оформлению кода.


PHP модуль
----------

Закрывающий PHP тег не ставится, если код занимает весь файл:

```php
<?php

# code

```


Интеграция PHP в HTML
---------------------

Выполняется с помощью коротких PHP тегов, например:

```php
<p>Today is a <?=($t > 20 ? 'warm' : 'cold')?> day!</p>
```

Данный проект предполагает, что короткие PHP теги обязательно включены. Если они не работают, следует обратиться к администратору и попросить включить их.


Комментарии
-----------

Используются несколько типов комментариев: заголовок модуля, заголовки секций, стратегические комментарии (назначение следующего блока кода) и тактические/инлайн (детали реализации).

### Заголовок модуля

В начале каждого модуля — короткий комментарий с его назначением:

```php
<?php
/* Core request analyser */

```

### Заголовки секций

Крупные логические блоки в файле отделяются заметными заголовками:

```php


/**
 * REQUEST NORMALIZATION
 * ---------------------
 */

```

Такой комментарий отбивается двумя пустыми строками сверху и одной пустой строкой снизу.

Заголовки второго уровня:

```php

## Normalization rules

```

Заголовки второстепенных блоков отбиваются пустыми строками сверху и снизу.

### Стратегические комментарии

Стратегические комментарии описывают назначение и ставятся перед блоком кода:

```php
# cut expensive processing for empty input
if (count($items) === 0) return [];
process_items($items);
```

Такие комментарии не дублируют код, а объясняют назначение, причину, ограничения, побочные эффекты.

### Тактические (инлайн) комментарии

Тактические комментарии поясняют неочевидные детали реализации. Краткие комментарии допускаются в конце строки, более длинные — перед строкой:

```php
$mask = $flags & 0b0100;  # extract "admin" bit
$is_admin = ($mask !== 0);
```

### Документирование


Разное
------

Рекомендации:
- комментарии пишутся на языке проекта (обычно английский);
- секции верхнего уровня комментируются в верхнем регистре;
- секции второго и третьего уровней комментируются с заглавной буквы;
- стратегические комментарии пишутся с заглавной буквы;
- тактические комментарии пишутся с маленькой буквы;
- не описываем очевидное "что делает код", фокус на "почему так" и "какие есть подводные камни".

Комментарии вида `//` используются только как временные, чтобы обратить на себя внимание, например:

```php

// TODO: do something very important!

```

