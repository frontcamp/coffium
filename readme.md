[![Coffium – The Only Real PHP Framework](docs/files/banner.png)](https://github.com/frontcamp/coffium)

Coffium (0.5.alpha)
===================

Процедурный минималистичный файлово-ориентированный PHP-фреймворк для проектов с повышенными требованиями к производительности и безопасности.


Минимальные требования
----------------------

- Сервер: Apache с поддержкой .htaccess и модуля mod_rewrite;
- PHP 8.3 и выше, с расширениями: <TODO: добавить список расширений>
- MySQL 5.5 и выше с правами на создание и изменение таблиц (требуется только для компонентов, работающих с БД)

Обратите внимание: текущая лицензия PNND разрешает использовать Coffium только для личных, учебных и внутренних проектов без коммерческого и production-использования. Для коммерческого использования требуется отдельное разрешение.


Идеология Coffium
-----------------

- процедурный фреймворк без ООП-надстроек и лишних оверхедов;
- файлово-ориентированная маршрутизация и декомпозиция;
- три варианта реализации статических страниц (инлайн, компонент с хранением контента в файлах или БД);
- минимальное ядро, функциональные компоненты;
- полный контроль запуска компонентов и обработчиков;
- максимальная производительность (/docs/performance.txt);
- ультимативная безопасность (/docs/security.txt);
- целевая аудитория: опытные разработчики, энтузиасты.


Возможности из коробки
----------------------

- компонентное ядро с документацией (/docs/core.txt)

В разработке:

- автозапуск или глобальный инициализатор (/coms/__init__.php)
- обработчик по умолчанию (/coms/act|tpl.default.php)
- статика (служебные страницы: Error 404, etc., /coms/static)
- административный интерфейс (/coms/admin)
- отладчик (/coms/debug)
- ZHTML CSS framework (/coms/common/frontcamp/zhtml)
- jQuery JavaScript library (/coms/common/openjsf/jquery)
- GeoIP база с демонстрацией (/coms/common/maxmind/geoip2)
- драйвер БД MySQL (/coms/db/*)
- менеджер таблиц БД (аналог phpMyAdmin, /coms/dbtm)
- статистика (/coms/stats)
- файловый кеш (/coms/cache)
- блокировщик подозрительной активности (/coms/blocker)
- пользователи (регистрация, вход, выход, профиль, восстановление пароля, /coms/user)
- компонент шаблонов разметки (/coms/layout)
- статические страницы (/coms/pages)
- комментирование (/coms/comments/)
- почтовые рассылки (/coms/mailer)
- личный блог (/coms/blog)

- демо работы ядра (/coms/demo/core)
- демо использования разметки (/coms/demo/layout)
- демо статической, динамической и AJAX-компоновки страниц (/coms/demo/handling)


Для кого Coffium
----------------

Требуются хорошие знания PHP, HTML, CSS и JavaScript. Coffium не для новичков, но если вы любите разбираться в системе и контролировать её до последнего бита, остановиться будет сложно.


Организация файловой системы
----------------------------

```
/coms     - компоненты
/data     - динамические данные (служебный каталог)
/docs     - документация по ядру, организации системы и безопасности
/libs     - библиотеки ядра
/logs     - логи
/temp     - временные файлы
.gitignore        - служебный Git файл
.htaccess         - управление внешним доступом
readme.md         - этот документ
config-custom.php - конфигурация проекта
config-global.php - конфигурация ядра, системы, PHP, спец. доступ
config-server.php - конфигурация сервер-зависимого окружения
index.php         - точка входа в обработку запроса
changelog.txt     - история изменений
license.txt       - текст лицензии
```


Установка
---------

Скачайте содержимое репозитория и скопируйте его на хостинг.


Быстрый старт
-------------

Система организована просто и интуитивно. Чтобы начать работу, сразу после копирования на хостинг откройте в браузере адрес:

https://<server>/admin

Введите логин/пароль (admin/admin) и вы попадете в административный интерфейс. В нем находятся: информация о состоянии и текущем составе системы, управление компонентами, инструменты разработки, диагностика ядра, настройки доступа и др.

Если ваш проект подразумевает работу с БД, доступ к БД можно настроить в файле конфигурации: config-server.php

Подробное описание конфигурации и принципов работы системы приведено в документации /docs/core.txt.

Документация по компонентам находится в каталогах самих компонентов:

/coms/{component}/_docs/*.txt

например:

/coms/db/_docs/*.txt

Документация по сторонним библиотекам находится в каталогах вендора и соответствующего продукта:

/coms/common/{vendor}/{product}/_docs/*.txt

например:

/coms/common/openjsf/jquery/_docs/*.txt

ВАЖНО: После настройки настоятельно рекомендуется открыть /docs/security.txt. В этом документе приведены чеклист и рекомендации по обеспечению безопасности системы.


Принцип декомпозиции
--------------------

Декомпозиция - один из ключевых принципов этого PHP-фреймворка. Структурными блоками системы являются компоненты и обработчики.

*Компонент* (component) - структурно самодостаточная часть бизнес-логики, которая может предоставлять API, виджеты и опционально обрабатывать входящие запросы с помощью обработчиков.

*Обработчик* (handler) - структурный элемент компонента, расположенный в его внутренней структуре каталогов, состоящий из файла с бизнес-логикой (act.{name}.php), шаблона вывода (tpl.{name}.php) и статики (в каталоге /web: стили, джаваскрипты и изображения).

Подробно описаны в документации ядра.
Компоненты связываются между собой с помощью механизма зависимостей. Запуск компонентов происходит поэтапно:
1) корневая инициализация (автозапуск компонентов-сервисов);
2) маршрутизация в соответствии с URL-запросом;
3) регрессия запроса при отсутствии конечного обработчика;
4) обработка исключительных ситуаций в обработчике по умолчанию;
5) выполнение финализаторов.

Таким образом, все элементы системы подключаются, подобно оркестру, в строго определенные моменты и расположены именно там, где этого логично ожидает разработчик.
Например, если нужно изменить иконку у поля в форме логина, зайдите в компонент управления пользователями:

/coms/user

Там находится виджет вывода формы логина:

/coms/user/widget/login

В нём находится каталог со статикой и нужная картинка:

/coms/user/widget/login/web/i/ico-user.webp

Таким образом, думая о любом элементе проекта, разработчик интуитивно понимает, где находится нужный обработчик и его статика.


Всем вкусного кофе!

